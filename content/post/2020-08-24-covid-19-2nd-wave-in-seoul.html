---
title: COVID-19 2nd Wave in Seoul
author: Seokjin Woo
date: '2020-08-24'
slug: covid-19-2nd-wave-in-seoul
categories:
  - R
tags:
  - R Markdown
---



<p>서울 코로나 상황이 심상치 않다. 2차 웨이브가 심하게 진행중이다.</p>
<p>서울시 사이트에서 확진자 현황을 가지고 와서 신규확진자 현황을 그려보았다.</p>
<p>필요한 라이브러리 로딩하자. 인코딩 때문에 <code>Sys.setlocale</code> 셋팅 하는 거 잊지 말자. 에러난다.</p>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## -- Attaching packages --- tidyverse 1.3.0 --</code></pre>
<pre><code>## ¡î ggplot2 3.3.0     ¡î purrr   0.3.3
## ¡î tibble  3.0.0     ¡î dplyr   0.8.5
## ¡î tidyr   1.0.0     ¡î stringr 1.4.0
## ¡î readr   1.3.1     ¡î forcats 0.4.0</code></pre>
<pre><code>## -- Conflicts ------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(rvest)</code></pre>
<pre><code>## ÇÊ¿äÇÑ ÆÐÅ°Áö¸¦ ·ÎµùÁßÀÔ´Ï´Ù: xml2</code></pre>
<pre><code>## 
## ´ÙÀ½ÀÇ ÆÐÅ°Áö¸¦ ºÎÂøÇÕ´Ï´Ù: &#39;rvest&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     pluck</code></pre>
<pre><code>## The following object is masked from &#39;package:readr&#39;:
## 
##     guess_encoding</code></pre>
<pre class="r"><code>Sys.setlocale(&quot;LC_ALL&quot;,&quot;English&quot;)</code></pre>
<pre><code>## [1] &quot;LC_COLLATE=English_United States.1252;LC_CTYPE=English_United States.1252;LC_MONETARY=English_United States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252&quot;</code></pre>
<p>서울시 코로나 사이트에 가서 확진자 현황 긁어 오자. 그리고 날짜 등에 대해서 형식을 약간 바꿔주자.</p>
<pre class="r"><code>url &lt;- &quot;https://www.seoul.go.kr/coronaV/coronaStatus.do#status_page_top&quot;

df &lt;- read_html(url) %&gt;% 
  html_nodes(&quot;div table &quot;) %&gt;% 
  html_table(fill = TRUE)

df.table &lt;- df[[7]]

names(df.table) &lt;- c(&quot;id&quot;, &quot;patientid&quot;, &quot;date_confirmed&quot;, &quot;residence&quot;, &quot;travel&quot;, &quot;contact&quot;,&quot;assign&quot;)


df.table$date_confirmed &lt;- as.Date(df.table$date_confirmed, format = &quot;%m.%d&quot;)</code></pre>
<p>이렇게 만들어진 자료를 이용하여 아래와 같은 그림을 그려보자.</p>
<pre class="r"><code>df.table %&gt;% 
  # filter(date_confirmed &gt;= &quot;2020-05-01&quot;) %&gt;% 
  mutate(type = ifelse(contact == &quot;성북구 사랑제일교회 관련&quot;, &quot;사랑제일교회&quot;, 
                       ifelse(contact == &quot;용인시 우리제일교회 관련&quot;,&quot;우리제일교회&quot;,&quot;기타&quot;))) %&gt;% 
  group_by(date_confirmed, type) %&gt;% 
  summarise(daily = n()) %&gt;% 
  ggplot(aes(x = date_confirmed, y = daily, fill = type)) +
  geom_bar(stat = &quot;identity&quot;, color = &quot;white&quot;) +
  geom_vline(xintercept = as.numeric(as.Date(&quot;2020-08-15&quot;)),
             color = &quot;red&quot;) + 
  scale_x_date(breaks = &quot;2 week&quot;, date_labels = &quot;%m-%d&quot;) +
  labs(
    title = &quot;2nd Covid-19 wave in Seoul&quot;,
    x = &quot;날짜&quot;,
    y = &quot;확진자수&quot;
  ) +
  theme_bw() +
  theme(legend.position = &quot;bottom&quot;,
        legend.title = element_blank()) +
  scale_fill_brewer(palette = &quot;Set1&quot;)</code></pre>
<p><img src="/post/2020-08-24-covid-19-2nd-wave-in-seoul_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
